(()=>{"use strict";class e{constructor(e,t,n,r){this.templateElement=document.getElementById(e),this.hostElement=document.getElementById(t);const s=document.importNode(this.templateElement.content,!0);this.element=s.firstElementChild,r&&(this.element.id=r),this.attach(n)}attach(e){this.hostElement.insertAdjacentElement(e?"afterbegin":"beforeend",this.element)}}function t(e){let t=!0;return e.required&&(t=t&&0!==e.value.toString().trim().length),null!=e.min&&"number"==typeof e.value&&(t=t&&e.value>=e.min),null!=e.max&&"number"==typeof e.value&&(t=t&&e.value<=e.max),null!=e.minLength&&"string"==typeof e.value&&(t=t&&e.value.trim().length>=e.minLength),null!=e.maxLength&&"string"==typeof e.value&&(t=t&&e.value.trim().length<=e.maxLength),t}function n(e,t,n){console.log(e),console.log(t),console.log(n);const r=n.value;return{configurable:!0,enumerable:!1,get(){return r.bind(this)}}}var r;!function(e){e[e.Active=0]="Active",e[e.Finished=1]="Finished"}(r||(r={}));class s{constructor(e,t,n,r,s){this.id=e,this.title=t,this.description=n,this.people=r,this.status=s}}class i extends class{constructor(){this.listeners=[]}addListener(e){console.log("listerFunction",e),console.log("this.listeners",this.listeners),this.listeners.push(e)}}{constructor(){super(),this.projects=[]}static getInstance(){return this.instance||(this.instance=new i),this.instance}addProjects(e,t,n){const i=new s(`${Math.random()}-${(new Date).getMilliseconds()}`,e,t,n,r.Active);this.projects.push(i),this.updateListeners()}moveProject(e,t){const n=this.projects.find((t=>t.id===e));n&&n.status!==t&&(n.status=t),this.updateListeners()}updateListeners(){for(const e of this.listeners)e(this.projects.slice())}}const l=i.getInstance();class o extends e{constructor(){super("project-input","app",!0,"user-input"),this.titleInputElement=this.element.querySelector("#title"),this.descriptionInputElement=this.element.querySelector("#description"),this.peopleInputElement=this.element.querySelector("#people"),this.configure()}configure(){this.element.addEventListener("submit",this.submitHandler)}renderContent(){}getUserInput(){const e=this.titleInputElement.value,n={value:this.descriptionInputElement.value,required:!0,minLength:5},r={value:+ +this.peopleInputElement.value,required:!0,min:1,max:10};if(t({value:e,required:!0})&&t(n)&&t(r))return[this.titleInputElement.value,this.descriptionInputElement.value,+this.peopleInputElement.value];alert("Invalid input, please try again later!")}submitHandler(e){e.preventDefault();const t=this.getUserInput();if(Array.isArray(t)){const[e,n,r]=t;console.log(e,n,r),l.addProjects(e,n,r),this.clearInput()}else console.log("Invalid Input!")}clearInput(){this.titleInputElement.value="",this.descriptionInputElement.value="",this.peopleInputElement.value=""}}!function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);i>3&&l&&Object.defineProperty(t,n,l)}([n],o.prototype,"submitHandler",null);class a extends e{constructor(e,t){super("single-project",e,!1,t.id),this.project=t,this.configure(),this.renderContent()}get persons(){return(1===this.project.people?" 1 person":`${this.project.people} persons`)+" "}dragStartHandler(e){console.log(e),e.dataTransfer.setData("text/plain",this.project.id),e.dataTransfer.effectAllowed="move"}dragEndHandler(e){console.log("Drag End",e)}configure(){this.element.addEventListener("dragstart",this.dragStartHandler),this.element.addEventListener("dragend",this.dragEndHandler)}renderContent(){this.element.querySelector("h2").textContent=this.project.title,this.element.querySelector("h3").textContent=this.persons+" assigned",this.element.querySelector("p").textContent=this.project.description}}!function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);i>3&&l&&Object.defineProperty(t,n,l)}([n],a.prototype,"dragStartHandler",null);var c=function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);return i>3&&l&&Object.defineProperty(t,n,l),l};class d extends e{constructor(e){super("project-list","app",!1,`${e}-projects`),this.type=e,this.assignedProjects=[],this.configure(),this.renderContent()}dragOverHandler(e){var t;"text/plain"===(null===(t=null==e?void 0:e.dataTransfer)||void 0===t?void 0:t.types[0])&&(e.preventDefault(),this.element.querySelector("ul").classList.add("droppable"))}dropHandler(e){const t=e.dataTransfer.getData("text/plain");l.moveProject(t,"active"===this.type?r.Active:r.Finished)}dragLeaveHandler(e){this.element.querySelector("ul").classList.remove("droppable")}configure(){this.element.addEventListener("dragover",this.dragOverHandler),this.element.addEventListener("dragleave",this.dragLeaveHandler),this.element.addEventListener("drop",this.dropHandler),l.addListener((e=>{console.log("projects...",e);const t=e.filter((e=>"active"===this.type?e.status===r.Active:e.status===r.Finished));this.assignedProjects=t,this.renderProjects()}))}renderContent(){const e=`${this.type}-project-list`;this.element.querySelector("ul").id=e,this.element.querySelector("h2").textContent=this.type.toUpperCase()+"PROJECTS"}renderProjects(){document.getElementById(`${this.type}-project-list`).innerHTML="";for(const e of this.assignedProjects)new a(this.element.querySelector("ul").id,e)}}c([n],d.prototype,"dragOverHandler",null),c([n],d.prototype,"dropHandler",null),c([n],d.prototype,"dragLeaveHandler",null),new o,new d("active"),new d("finished"),console.log("Hi")})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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bUcsaUJBQzdCLElBQUlYLEVBQVl4RixLQUFLUSxRQUFROEQsY0FBYyxNQUFPNUQsR0FBSTBHLEVBRTFELEVBeERBLEdBREMzRixHLG9DQVVELEdBRENBLEcsZ0NBVUQsR0FEQ0EsRyxxQ0M1QkgsSUFBSTJDLEVBQ0osSUFBSTZCLEVBQVksVUFDaEIsSUFBSUEsRUFBWSxZQUVoQnBFLFFBQVFDLElBQUksSyIsInNvdXJjZXMiOlsid2VicGFjazovLzAxLS0tdHlwZXNjcmlwdC1iYXNpY3MvLi9zcmMvY29tcG9uZW50cy9iYXNlLWNvbXBvbmVudC50cyIsIndlYnBhY2s6Ly8wMS0tLXR5cGVzY3JpcHQtYmFzaWNzLy4vc3JjL3V0aWxzL3ZhbGlkYXRpb24udHMiLCJ3ZWJwYWNrOi8vMDEtLS10eXBlc2NyaXB0LWJhc2ljcy8uL3NyYy9kZWNvcmF0b3JzL2F1dG9iaW5kLnRzIiwid2VicGFjazovLzAxLS0tdHlwZXNjcmlwdC1iYXNpY3MvLi9zcmMvbW9kZWxzL3Byb2plY3QudHMiLCJ3ZWJwYWNrOi8vMDEtLS10eXBlc2NyaXB0LWJhc2ljcy8uL3NyYy9zdGF0ZS9wcm9qZWN0LnRzIiwid2VicGFjazovLzAxLS0tdHlwZXNjcmlwdC1iYXNpY3MvLi9zcmMvY29tcG9uZW50cy9wcm9qZWN0LWlucHV0LnRzIiwid2VicGFjazovLzAxLS0tdHlwZXNjcmlwdC1iYXNpY3MvLi9zcmMvY29tcG9uZW50cy9wcm9qZWN0LWl0ZW0udHMiLCJ3ZWJwYWNrOi8vMDEtLS10eXBlc2NyaXB0LWJhc2ljcy8uL3NyYy9jb21wb25lbnRzL3Byb2plY3QtbGlzdC50cyIsIndlYnBhY2s6Ly8wMS0tLXR5cGVzY3JpcHQtYmFzaWNzLy4vc3JjL2FwcC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvL0NvbXBvbmVudCBCYXNlIENsYXNzXHJcbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBDb21wb25lbnQ8VCBleHRlbmRzIEhUTUxFbGVtZW50LCBVIGV4dGVuZHMgSFRNTEVsZW1lbnQ+IHtcclxuICAvL2Fic3RhY3QsIHNob3VsZCBuZXZlciBkaXJlY2x0eSBiZSBpbnN0YW5jaWF0ZWQuIEl0IHNob3VsZCBvbmx5IGJlIHVzZWQgZm9yIGluaGVyaXRhbmNlLlxyXG4gIHRlbXBsYXRlRWxlbWVudDogSFRNTFRlbXBsYXRlRWxlbWVudDtcclxuICBob3N0RWxlbWVudDogVDtcclxuICBlbGVtZW50OiBVO1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgdGVtcGxhdGVJZDogc3RyaW5nLFxyXG4gICAgaG9zdEVsZW1lbnRJZDogc3RyaW5nLFxyXG4gICAgaW5zZXJ0U3RhcnQ6IGJvb2xlYW4sXHJcbiAgICBuZXdFbGVtZW50SWQ/OiBzdHJpbmdcclxuICApIHtcclxuICAgIHRoaXMudGVtcGxhdGVFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXHJcbiAgICAgIHRlbXBsYXRlSWRcclxuICAgICkhIGFzIEhUTUxUZW1wbGF0ZUVsZW1lbnQ7XHJcbiAgICB0aGlzLmhvc3RFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaG9zdEVsZW1lbnRJZCkhIGFzIFQ7XHJcbiAgICBjb25zdCBpbXBvcnRlZE5vZGUgPSBkb2N1bWVudC5pbXBvcnROb2RlKFxyXG4gICAgICB0aGlzLnRlbXBsYXRlRWxlbWVudC5jb250ZW50LFxyXG4gICAgICB0cnVlXHJcbiAgICApO1xyXG4gICAgdGhpcy5lbGVtZW50ID0gaW1wb3J0ZWROb2RlLmZpcnN0RWxlbWVudENoaWxkIGFzIFU7XHJcbiAgICBpZiAobmV3RWxlbWVudElkKSB7XHJcbiAgICAgIHRoaXMuZWxlbWVudC5pZCA9IG5ld0VsZW1lbnRJZDtcclxuICAgIH1cclxuICAgIHRoaXMuYXR0YWNoKGluc2VydFN0YXJ0KTtcclxuICB9XHJcbiAgcHJpdmF0ZSBhdHRhY2goaW5zZXJ0U3RhcnQ6IGJvb2xlYW4pIHtcclxuICAgIHRoaXMuaG9zdEVsZW1lbnQuaW5zZXJ0QWRqYWNlbnRFbGVtZW50KFxyXG4gICAgICBpbnNlcnRTdGFydCA/ICdhZnRlcmJlZ2luJyA6ICdiZWZvcmVlbmQnLFxyXG4gICAgICB0aGlzLmVsZW1lbnRcclxuICAgICk7XHJcbiAgfVxyXG4gIGFic3RyYWN0IGNvbmZpZ3VyZSgpOiB2b2lkO1xyXG4gIGFic3RyYWN0IHJlbmRlckNvbnRlbnQoKTogdm9pZDtcclxufVxyXG4iLCIvL1ZhbGlkYXRpb25cclxuZXhwb3J0IGludGVyZmFjZSBWYWxpZGF0YWJsZSB7XHJcbiAgdmFsdWU6IHN0cmluZyB8IG51bWJlcjsgLy8/ID0gb3B0aW9uYWxcclxuICByZXF1aXJlZD86IGJvb2xlYW47XHJcbiAgbWluTGVuZ3RoPzogbnVtYmVyO1xyXG4gIG1heExlbmd0aD86IG51bWJlcjtcclxuICBtaW4/OiBudW1iZXI7XHJcbiAgbWF4PzogbnVtYmVyO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGUoaW5wdXQ6IFZhbGlkYXRhYmxlKSB7XHJcbiAgbGV0IGlzVmFsaWQgPSB0cnVlO1xyXG4gIGlmIChpbnB1dC5yZXF1aXJlZCkge1xyXG4gICAgaXNWYWxpZCA9IGlzVmFsaWQgJiYgaW5wdXQudmFsdWUudG9TdHJpbmcoKS50cmltKCkubGVuZ3RoICE9PSAwO1xyXG4gIH1cclxuICBpZiAoaW5wdXQubWluICE9IG51bGwgJiYgdHlwZW9mIGlucHV0LnZhbHVlID09PSAnbnVtYmVyJykge1xyXG4gICAgaXNWYWxpZCA9IGlzVmFsaWQgJiYgaW5wdXQudmFsdWUgPj0gaW5wdXQubWluO1xyXG4gIH1cclxuICBpZiAoaW5wdXQubWF4ICE9IG51bGwgJiYgdHlwZW9mIGlucHV0LnZhbHVlID09PSAnbnVtYmVyJykge1xyXG4gICAgaXNWYWxpZCA9IGlzVmFsaWQgJiYgaW5wdXQudmFsdWUgPD0gaW5wdXQubWF4O1xyXG4gIH1cclxuICBpZiAoaW5wdXQubWluTGVuZ3RoICE9IG51bGwgJiYgdHlwZW9mIGlucHV0LnZhbHVlID09PSAnc3RyaW5nJykge1xyXG4gICAgaXNWYWxpZCA9IGlzVmFsaWQgJiYgaW5wdXQudmFsdWUudHJpbSgpLmxlbmd0aCA+PSBpbnB1dC5taW5MZW5ndGg7XHJcbiAgfVxyXG4gIGlmIChpbnB1dC5tYXhMZW5ndGggIT0gbnVsbCAmJiB0eXBlb2YgaW5wdXQudmFsdWUgPT09ICdzdHJpbmcnKSB7XHJcbiAgICBpc1ZhbGlkID0gaXNWYWxpZCAmJiBpbnB1dC52YWx1ZS50cmltKCkubGVuZ3RoIDw9IGlucHV0Lm1heExlbmd0aDtcclxuICB9XHJcbiAgcmV0dXJuIGlzVmFsaWQ7XHJcbn1cclxuIiwiLy9BdXRvYmluZGluZ1xyXG5leHBvcnQgZnVuY3Rpb24gQXV0b0JpbmRlcihcclxuICB0YXJnZXQ6IGFueSxcclxuICBtZXRob2ROYW1lOiBzdHJpbmcgfCBzeW1ib2wsXHJcbiAgZGVzY3JpcHRvcjogUHJvcGVydHlEZXNjcmlwdG9yXHJcbikge1xyXG4gIGNvbnNvbGUubG9nKHRhcmdldCk7XHJcbiAgY29uc29sZS5sb2cobWV0aG9kTmFtZSk7XHJcbiAgY29uc29sZS5sb2coZGVzY3JpcHRvcik7XHJcblxyXG4gIGNvbnN0IG9yaWdpbmFsTWV0aG9kID0gZGVzY3JpcHRvci52YWx1ZTtcclxuICAvLyBjb25zb2xlLmxvZyhvcmlnaW5hbE1ldGhvZCk7XHJcblxyXG4gIGNvbnN0IG5ld0Rlc2NyaXB0b3I6IFByb3BlcnR5RGVzY3JpcHRvciA9IHtcclxuICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcclxuICAgIGVudW1lcmFibGU6IGZhbHNlLFxyXG4gICAgZ2V0KCkge1xyXG4gICAgICAvLyBjb25zb2xlLmxvZygnVGhpcycsIHRoaXMpO1xyXG4gICAgICBjb25zdCBib3VuZEZuID0gb3JpZ2luYWxNZXRob2QuYmluZCh0aGlzKTtcclxuICAgICAgcmV0dXJuIGJvdW5kRm47XHJcbiAgICB9LFxyXG4gIH07XHJcbiAgcmV0dXJuIG5ld0Rlc2NyaXB0b3I7XHJcbn1cclxuIiwiZXhwb3J0IGVudW0gUHJvamVjdFN0YXR1cyB7XHJcbiAgQWN0aXZlLFxyXG4gIEZpbmlzaGVkLFxyXG59XHJcblxyXG4vL1Byb2plY3QgQ2xhc3NcclxuZXhwb3J0IGNsYXNzIFByb2plY3Qge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHVibGljIGlkOiBzdHJpbmcsXHJcbiAgICBwdWJsaWMgdGl0bGU6IHN0cmluZyxcclxuICAgIHB1YmxpYyBkZXNjcmlwdGlvbjogc3RyaW5nLFxyXG4gICAgcHVibGljIHBlb3BsZTogbnVtYmVyLFxyXG4gICAgcHVibGljIHN0YXR1czogUHJvamVjdFN0YXR1c1xyXG4gICkge31cclxufVxyXG4iLCJpbXBvcnQgeyBQcm9qZWN0LCBQcm9qZWN0U3RhdHVzIH0gZnJvbSAnLi4vbW9kZWxzL3Byb2plY3QnO1xyXG50eXBlIExpc3RlbmVyPFQ+ID0gKGl0ZW1zOiBUW10pID0+IHZvaWQ7XHJcbi8vUHJvamVjdFN0YXRlIENsYXNzXHJcbmNsYXNzIFN0YXRlPFQ+IHtcclxuICBwcm90ZWN0ZWQgbGlzdGVuZXJzOiBMaXN0ZW5lcjxUPltdID0gW107XHJcblxyXG4gIGFkZExpc3RlbmVyKGxpc3RlckZ1bmN0aW9uOiBMaXN0ZW5lcjxUPikge1xyXG4gICAgY29uc29sZS5sb2coJ2xpc3RlckZ1bmN0aW9uJywgbGlzdGVyRnVuY3Rpb24pO1xyXG4gICAgY29uc29sZS5sb2coJ3RoaXMubGlzdGVuZXJzJywgdGhpcy5saXN0ZW5lcnMpO1xyXG5cclxuICAgIHRoaXMubGlzdGVuZXJzLnB1c2gobGlzdGVyRnVuY3Rpb24pO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIFByb2plY3RTdGF0ZSBleHRlbmRzIFN0YXRlPFByb2plY3Q+IHtcclxuICBwcml2YXRlIHByb2plY3RzOiBQcm9qZWN0W10gPSBbXTtcclxuICBwcml2YXRlIHN0YXRpYyBpbnN0YW5jZTogUHJvamVjdFN0YXRlO1xyXG5cclxuICBwcml2YXRlIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgc3VwZXIoKTtcclxuICB9XHJcblxyXG4gIHN0YXRpYyBnZXRJbnN0YW5jZSgpIHtcclxuICAgIGlmICh0aGlzLmluc3RhbmNlKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLmluc3RhbmNlO1xyXG4gICAgfVxyXG4gICAgdGhpcy5pbnN0YW5jZSA9IG5ldyBQcm9qZWN0U3RhdGUoKTtcclxuICAgIHJldHVybiB0aGlzLmluc3RhbmNlO1xyXG4gIH1cclxuXHJcbiAgYWRkUHJvamVjdHModGl0bGU6IHN0cmluZywgZGVzY3JpcHRpb246IHN0cmluZywgcGVvcGxlOiBudW1iZXIpIHtcclxuICAgIGNvbnN0IG5ld1Byb2plY3QgPSBuZXcgUHJvamVjdChcclxuICAgICAgYCR7TWF0aC5yYW5kb20oKX0tJHtuZXcgRGF0ZSgpLmdldE1pbGxpc2Vjb25kcygpfWAsXHJcbiAgICAgIHRpdGxlLFxyXG4gICAgICBkZXNjcmlwdGlvbixcclxuICAgICAgcGVvcGxlLFxyXG4gICAgICBQcm9qZWN0U3RhdHVzLkFjdGl2ZVxyXG4gICAgKTtcclxuICAgIHRoaXMucHJvamVjdHMucHVzaChuZXdQcm9qZWN0KTtcclxuICAgIHRoaXMudXBkYXRlTGlzdGVuZXJzKCk7XHJcbiAgfVxyXG4gIG1vdmVQcm9qZWN0KHByb2plY3RJZDogc3RyaW5nLCBuZXdTdGF0dXM6IFByb2plY3RTdGF0dXMpIHtcclxuICAgIGNvbnN0IHByb2plY3QgPSB0aGlzLnByb2plY3RzLmZpbmQoKHByb2plY3QpID0+IHtcclxuICAgICAgcmV0dXJuIHByb2plY3QuaWQgPT09IHByb2plY3RJZDtcclxuICAgIH0pO1xyXG4gICAgaWYgKHByb2plY3QgJiYgcHJvamVjdC5zdGF0dXMgIT09IG5ld1N0YXR1cykge1xyXG4gICAgICBwcm9qZWN0LnN0YXR1cyA9IG5ld1N0YXR1cztcclxuICAgIH1cclxuICAgIHRoaXMudXBkYXRlTGlzdGVuZXJzKCk7XHJcbiAgfVxyXG4gIHByaXZhdGUgdXBkYXRlTGlzdGVuZXJzKCkge1xyXG4gICAgZm9yIChjb25zdCBsaXN0ZW5lckZ1bmN0aW9uIG9mIHRoaXMubGlzdGVuZXJzKSB7XHJcbiAgICAgIGxpc3RlbmVyRnVuY3Rpb24odGhpcy5wcm9qZWN0cy5zbGljZSgpKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuZXhwb3J0IGNvbnN0IHByb2plY3RTdGF0ZSA9IFByb2plY3RTdGF0ZS5nZXRJbnN0YW5jZSgpO1xyXG4iLCJcclxuLy8gLyA8cmVmZXJlbmNlIHBhdGg9XCJiYXNlLWNvbXBvbmVudC50c1wiIC8+XHJcbmltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gJy4vYmFzZS1jb21wb25lbnQnO1xyXG5pbXBvcnQgeyBUdXBsZU9yVm9pZCB9IGZyb20gJy4vLi4vdHlwZXMvdHVwbGUtdm9pZCc7XHJcbmltcG9ydCB7IFZhbGlkYXRhYmxlLCB2YWxpZGF0ZSB9IGZyb20gJy4uL3V0aWxzL3ZhbGlkYXRpb24nO1xyXG5pbXBvcnQgeyBBdXRvQmluZGVyIH0gZnJvbSAnLi4vZGVjb3JhdG9ycy9hdXRvYmluZCc7XHJcbmltcG9ydCB7IHByb2plY3RTdGF0ZSB9IGZyb20gJy4uL3N0YXRlL3Byb2plY3QnO1xyXG4vL1Byb2plY3RJbnB1dCBDbGFzc1xyXG5leHBvcnQgY2xhc3MgUHJvamVjdElucHV0IGV4dGVuZHMgQ29tcG9uZW50PEhUTUxEaXZFbGVtZW50LCBIVE1MRm9ybUVsZW1lbnQ+IHtcclxuICB0aXRsZUlucHV0RWxlbWVudDogSFRNTElucHV0RWxlbWVudDtcclxuICBkZXNjcmlwdGlvbklucHV0RWxlbWVudDogSFRNTElucHV0RWxlbWVudDtcclxuICBwZW9wbGVJbnB1dEVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnQ7XHJcblxyXG4gIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgc3VwZXIoJ3Byb2plY3QtaW5wdXQnLCAnYXBwJywgdHJ1ZSwgJ3VzZXItaW5wdXQnKTtcclxuICAgIHRoaXMudGl0bGVJbnB1dEVsZW1lbnQgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgJyN0aXRsZSdcclxuICAgICkgYXMgSFRNTElucHV0RWxlbWVudDtcclxuXHJcbiAgICB0aGlzLmRlc2NyaXB0aW9uSW5wdXRFbGVtZW50ID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgICcjZGVzY3JpcHRpb24nXHJcbiAgICApIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XHJcblxyXG4gICAgdGhpcy5wZW9wbGVJbnB1dEVsZW1lbnQgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgJyNwZW9wbGUnXHJcbiAgICApIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XHJcbiAgICB0aGlzLmNvbmZpZ3VyZSgpO1xyXG4gIH1cclxuXHJcbiAgY29uZmlndXJlKCkge1xyXG4gICAgLy8gdGhpcy5mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCB0aGlzLnN1Ym1pdEhhbmRsZXIuYmluZCh0aGlzKSk7XHJcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgdGhpcy5zdWJtaXRIYW5kbGVyKTtcclxuICB9XHJcbiAgcmVuZGVyQ29udGVudCgpOiB2b2lkIHt9XHJcblxyXG4gIHByaXZhdGUgZ2V0VXNlcklucHV0KCk6IFR1cGxlT3JWb2lkIHtcclxuICAgIGNvbnN0IGVudGVyZWRUaXRsZSA9IHRoaXMudGl0bGVJbnB1dEVsZW1lbnQudmFsdWU7XHJcbiAgICBjb25zdCBlbnRlcmVkRGVzY3JpcHRpb24gPSB0aGlzLmRlc2NyaXB0aW9uSW5wdXRFbGVtZW50LnZhbHVlO1xyXG4gICAgY29uc3QgZW50ZXJlZFBlb3BsZSA9ICt0aGlzLnBlb3BsZUlucHV0RWxlbWVudC52YWx1ZTtcclxuXHJcbiAgICBjb25zdCB0aXRsZVZhbGlkYXRhYmxlOiBWYWxpZGF0YWJsZSA9IHtcclxuICAgICAgdmFsdWU6IGVudGVyZWRUaXRsZSxcclxuICAgICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgICB9O1xyXG4gICAgY29uc3QgZGVzY3JpcHRpb25WYWxpZGF0YWJsZTogVmFsaWRhdGFibGUgPSB7XHJcbiAgICAgIHZhbHVlOiBlbnRlcmVkRGVzY3JpcHRpb24sXHJcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgICBtaW5MZW5ndGg6IDUsXHJcbiAgICB9O1xyXG4gICAgY29uc3QgcGVvcGxlVmFsaWRhdGFibGU6IFZhbGlkYXRhYmxlID0ge1xyXG4gICAgICB2YWx1ZTogK2VudGVyZWRQZW9wbGUsXHJcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgICBtaW46IDEsXHJcbiAgICAgIG1heDogMTAsXHJcbiAgICB9O1xyXG5cclxuICAgIC8vQ291bGQgaW1wcm92ZSB0aGUgdmFsaWRhdGlvbiwgbWFrZSBpdCBtb3JlIHNjYWxhYmxlXHJcbiAgICBpZiAoXHJcbiAgICAgICF2YWxpZGF0ZSh0aXRsZVZhbGlkYXRhYmxlKSB8fFxyXG4gICAgICAhdmFsaWRhdGUoZGVzY3JpcHRpb25WYWxpZGF0YWJsZSkgfHxcclxuICAgICAgIXZhbGlkYXRlKHBlb3BsZVZhbGlkYXRhYmxlKVxyXG4gICAgKSB7XHJcbiAgICAgIGFsZXJ0KCdJbnZhbGlkIGlucHV0LCBwbGVhc2UgdHJ5IGFnYWluIGxhdGVyIScpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICByZXR1cm4gW1xyXG4gICAgICB0aGlzLnRpdGxlSW5wdXRFbGVtZW50LnZhbHVlLFxyXG4gICAgICB0aGlzLmRlc2NyaXB0aW9uSW5wdXRFbGVtZW50LnZhbHVlLFxyXG4gICAgICArdGhpcy5wZW9wbGVJbnB1dEVsZW1lbnQudmFsdWUsXHJcbiAgICBdO1xyXG4gIH1cclxuXHJcbiAgQEF1dG9CaW5kZXJcclxuICBwcml2YXRlIHN1Ym1pdEhhbmRsZXIoZXZlbnQ6IEV2ZW50KSB7XHJcbiAgICAvLyBjb25zb2xlLmxvZyhldmVudCk7XHJcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgIGNvbnN0IHVzZXJJbnB1dCA9IHRoaXMuZ2V0VXNlcklucHV0KCk7XHJcblxyXG4gICAgaWYgKEFycmF5LmlzQXJyYXkodXNlcklucHV0KSkge1xyXG4gICAgICBjb25zdCBbdGl0bGUsIGRlc2NyaXB0aW9uLCBwZW9wbGVdID0gdXNlcklucHV0O1xyXG4gICAgICBjb25zb2xlLmxvZyh0aXRsZSwgZGVzY3JpcHRpb24sIHBlb3BsZSk7XHJcbiAgICAgIHByb2plY3RTdGF0ZS5hZGRQcm9qZWN0cyh0aXRsZSwgZGVzY3JpcHRpb24sIHBlb3BsZSk7XHJcbiAgICAgIHRoaXMuY2xlYXJJbnB1dCgpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY29uc29sZS5sb2coJ0ludmFsaWQgSW5wdXQhJyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGNsZWFySW5wdXQoKSB7XHJcbiAgICB0aGlzLnRpdGxlSW5wdXRFbGVtZW50LnZhbHVlID0gJyc7XHJcbiAgICB0aGlzLmRlc2NyaXB0aW9uSW5wdXRFbGVtZW50LnZhbHVlID0gJyc7XHJcbiAgICB0aGlzLnBlb3BsZUlucHV0RWxlbWVudC52YWx1ZSA9ICcnO1xyXG4gIH1cclxufVxyXG4iLCIvLyAvIDxyZWZlcmVuY2UgcGF0aD1cImJhc2UtY29tcG9uZW50LnRzXCIgLz5cclxuXHJcbmltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gJy4vYmFzZS1jb21wb25lbnQnO1xyXG5pbXBvcnQgeyBEcmFnZ2FibGUgfSBmcm9tICcuLi9pbnRlcmZhY2VzL2RyYWctYW5kLWRyb3AnO1xyXG5pbXBvcnQgeyBQcm9qZWN0IH0gZnJvbSAnLi4vbW9kZWxzL3Byb2plY3QnO1xyXG5pbXBvcnQgeyBBdXRvQmluZGVyIH0gZnJvbSAnLi4vZGVjb3JhdG9ycy9hdXRvYmluZCc7XHJcbi8vUHJvamVjdEl0ZW0gQ2xhc3NcclxuZXhwb3J0IGNsYXNzIFByb2plY3RJdGVtXHJcbiAgZXh0ZW5kcyBDb21wb25lbnQ8SFRNTFVMaXN0RWxlbWVudCwgSFRNTExJRWxlbWVudD5cclxuICBpbXBsZW1lbnRzIERyYWdnYWJsZVxyXG57XHJcbiAgcHJpdmF0ZSBwcm9qZWN0OiBQcm9qZWN0O1xyXG5cclxuICBnZXQgcGVyc29ucygpIHtcclxuICAgIHJldHVybiBgJHtcclxuICAgICAgdGhpcy5wcm9qZWN0LnBlb3BsZSA9PT0gMSA/ICcgMSBwZXJzb24nIDogYCR7dGhpcy5wcm9qZWN0LnBlb3BsZX0gcGVyc29uc2BcclxuICAgIH0gYDtcclxuICB9XHJcbiAgY29uc3RydWN0b3IoaG9zdElkOiBzdHJpbmcsIHByb2plY3Q6IFByb2plY3QpIHtcclxuICAgIHN1cGVyKCdzaW5nbGUtcHJvamVjdCcsIGhvc3RJZCwgZmFsc2UsIHByb2plY3QuaWQpO1xyXG4gICAgdGhpcy5wcm9qZWN0ID0gcHJvamVjdDtcclxuICAgIHRoaXMuY29uZmlndXJlKCk7XHJcbiAgICB0aGlzLnJlbmRlckNvbnRlbnQoKTtcclxuICB9XHJcbiAgQEF1dG9CaW5kZXJcclxuICBkcmFnU3RhcnRIYW5kbGVyKGV2ZW50OiBEcmFnRXZlbnQpOiB2b2lkIHtcclxuICAgIGNvbnNvbGUubG9nKGV2ZW50KTtcclxuICAgIGV2ZW50LmRhdGFUcmFuc2ZlciEuc2V0RGF0YSgndGV4dC9wbGFpbicsIHRoaXMucHJvamVjdC5pZCk7XHJcbiAgICBldmVudC5kYXRhVHJhbnNmZXIhLmVmZmVjdEFsbG93ZWQgPSAnbW92ZSc7XHJcbiAgfVxyXG5cclxuICBkcmFnRW5kSGFuZGxlcihldmVudDogRHJhZ0V2ZW50KTogdm9pZCB7XHJcbiAgICBjb25zb2xlLmxvZygnRHJhZyBFbmQnLCBldmVudCk7XHJcbiAgfVxyXG5cclxuICBjb25maWd1cmUoKTogdm9pZCB7XHJcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ3N0YXJ0JywgdGhpcy5kcmFnU3RhcnRIYW5kbGVyKTtcclxuICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcmFnZW5kJywgdGhpcy5kcmFnRW5kSGFuZGxlcik7XHJcbiAgfVxyXG5cclxuICByZW5kZXJDb250ZW50KCk6IHZvaWQge1xyXG4gICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2gyJykhLnRleHRDb250ZW50ID0gdGhpcy5wcm9qZWN0LnRpdGxlO1xyXG4gICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2gzJykhLnRleHRDb250ZW50ID0gdGhpcy5wZXJzb25zICsgJyBhc3NpZ25lZCc7XHJcblxyXG4gICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3AnKSEudGV4dENvbnRlbnQgPSB0aGlzLnByb2plY3QuZGVzY3JpcHRpb247XHJcbiAgfVxyXG59XHJcbiIsIi8vIC8gPHJlZmVyZW5jZSBwYXRoPVwiYmFzZS1jb21wb25lbnQudHNcIiAvPlxyXG5pbXBvcnQgeyBDb21wb25lbnQgfSBmcm9tICcuL2Jhc2UtY29tcG9uZW50JztcclxuaW1wb3J0IHsgUHJvamVjdEl0ZW0gfSBmcm9tICcuL3Byb2plY3QtaXRlbSc7XHJcbmltcG9ydCB7IERyb3BwYWJsZSB9IGZyb20gJy4uL2ludGVyZmFjZXMvZHJhZy1hbmQtZHJvcCc7XHJcbmltcG9ydCB7IFByb2plY3QgfSBmcm9tICcuLi9tb2RlbHMvcHJvamVjdCc7XHJcbmltcG9ydCB7IEF1dG9CaW5kZXIgfSBmcm9tICcuLi9kZWNvcmF0b3JzL2F1dG9iaW5kJztcclxuaW1wb3J0IHsgcHJvamVjdFN0YXRlIH0gZnJvbSAnLi4vc3RhdGUvcHJvamVjdCc7XHJcbmltcG9ydCB7IFByb2plY3RTdGF0dXMgfSBmcm9tICcuLi9tb2RlbHMvcHJvamVjdCc7XHJcbi8vUHJvamVjdExpc3QgQ2xhc3NcclxuZXhwb3J0IGNsYXNzIFByb2plY3RMaXN0XHJcbiAgZXh0ZW5kcyBDb21wb25lbnQ8SFRNTERpdkVsZW1lbnQsIEhUTUxFbGVtZW50PlxyXG4gIGltcGxlbWVudHMgRHJvcHBhYmxlXHJcbntcclxuICBhc3NpZ25lZFByb2plY3RzOiBQcm9qZWN0W107XHJcblxyXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgdHlwZTogJ2FjdGl2ZScgfCAnZmluaXNoZWQnKSB7XHJcbiAgICBzdXBlcigncHJvamVjdC1saXN0JywgJ2FwcCcsIGZhbHNlLCBgJHt0eXBlfS1wcm9qZWN0c2ApO1xyXG5cclxuICAgIHRoaXMuYXNzaWduZWRQcm9qZWN0cyA9IFtdO1xyXG4gICAgdGhpcy5jb25maWd1cmUoKTtcclxuICAgIHRoaXMucmVuZGVyQ29udGVudCgpO1xyXG4gIH1cclxuXHJcbiAgQEF1dG9CaW5kZXJcclxuICBkcmFnT3ZlckhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCk6IHZvaWQge1xyXG4gICAgaWYgKGV2ZW50Py5kYXRhVHJhbnNmZXI/LnR5cGVzWzBdID09PSAndGV4dC9wbGFpbicpIHtcclxuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgY29uc3QgbGlzdEVsZW1lbnQgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcigndWwnKSE7XHJcbiAgICAgIGxpc3RFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ2Ryb3BwYWJsZScpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgQEF1dG9CaW5kZXJcclxuICBkcm9wSGFuZGxlcihldmVudDogRHJhZ0V2ZW50KTogdm9pZCB7XHJcbiAgICBjb25zdCBwcm9qZWN0SWQgPSBldmVudC5kYXRhVHJhbnNmZXIhLmdldERhdGEoJ3RleHQvcGxhaW4nKTtcclxuICAgIHByb2plY3RTdGF0ZS5tb3ZlUHJvamVjdChcclxuICAgICAgcHJvamVjdElkLFxyXG4gICAgICB0aGlzLnR5cGUgPT09ICdhY3RpdmUnID8gUHJvamVjdFN0YXR1cy5BY3RpdmUgOiBQcm9qZWN0U3RhdHVzLkZpbmlzaGVkXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgQEF1dG9CaW5kZXJcclxuICBkcmFnTGVhdmVIYW5kbGVyKGV2ZW50OiBEcmFnRXZlbnQpOiB2b2lkIHtcclxuICAgIGNvbnN0IGxpc3RFbGVtZW50ID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3VsJykhO1xyXG4gICAgbGlzdEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnZHJvcHBhYmxlJyk7XHJcbiAgfVxyXG5cclxuICBjb25maWd1cmUoKTogdm9pZCB7XHJcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ292ZXInLCB0aGlzLmRyYWdPdmVySGFuZGxlcik7XHJcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2xlYXZlJywgdGhpcy5kcmFnTGVhdmVIYW5kbGVyKTtcclxuICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcm9wJywgdGhpcy5kcm9wSGFuZGxlcik7XHJcblxyXG4gICAgcHJvamVjdFN0YXRlLmFkZExpc3RlbmVyKChwcm9qZWN0czogUHJvamVjdFtdKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdwcm9qZWN0cy4uLicsIHByb2plY3RzKTtcclxuICAgICAgY29uc3QgcmVsZXZhbnRQcm9qZWN0cyA9IHByb2plY3RzLmZpbHRlcigocHJqKSA9PiB7XHJcbiAgICAgICAgaWYgKHRoaXMudHlwZSA9PT0gJ2FjdGl2ZScpIHtcclxuICAgICAgICAgIHJldHVybiBwcmouc3RhdHVzID09PSBQcm9qZWN0U3RhdHVzLkFjdGl2ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHByai5zdGF0dXMgPT09IFByb2plY3RTdGF0dXMuRmluaXNoZWQ7XHJcbiAgICAgIH0pO1xyXG4gICAgICB0aGlzLmFzc2lnbmVkUHJvamVjdHMgPSByZWxldmFudFByb2plY3RzO1xyXG4gICAgICB0aGlzLnJlbmRlclByb2plY3RzKCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHJlbmRlckNvbnRlbnQoKSB7XHJcbiAgICBjb25zdCBsaXN0SWQgPSBgJHt0aGlzLnR5cGV9LXByb2plY3QtbGlzdGA7XHJcbiAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcigndWwnKSEuaWQgPSBsaXN0SWQ7XHJcbiAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignaDInKSEudGV4dENvbnRlbnQgPVxyXG4gICAgICB0aGlzLnR5cGUudG9VcHBlckNhc2UoKSArICdQUk9KRUNUUyc7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHJlbmRlclByb2plY3RzKCkge1xyXG4gICAgY29uc3QgbGlzdEVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcclxuICAgICAgYCR7dGhpcy50eXBlfS1wcm9qZWN0LWxpc3RgXHJcbiAgICApISBhcyBIVE1MVUxpc3RFbGVtZW50O1xyXG4gICAgbGlzdEVsZW1lbnQuaW5uZXJIVE1MID0gJyc7XHJcbiAgICBmb3IgKGNvbnN0IHByb2plY3RJdGVtIG9mIHRoaXMuYXNzaWduZWRQcm9qZWN0cykge1xyXG4gICAgICBuZXcgUHJvamVjdEl0ZW0odGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3VsJykhLmlkLCBwcm9qZWN0SXRlbSk7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbiIsIi8vIC8gPHJlZmVyZW5jZSBwYXRoPVwiLi9pbnRlcmZhY2VzL2RyYWctYW5kLWRyb3AudHNcIi8+XHJcbi8vIC8gPHJlZmVyZW5jZSBwYXRoPVwiLi9tb2RlbHMvcHJvamVjdC50c1wiLz5cclxuLy8gLyA8cmVmZXJlbmNlIHBhdGg9XCIuL3N0YXRlL3Byb2plY3QudHNcIi8+XHJcbi8vIC8gPHJlZmVyZW5jZSBwYXRoPVwiLi91dGlscy92YWxpZGF0aW9uLnRzXCIvPlxyXG4vLyAvIDxyZWZlcmVuY2UgcGF0aD1cIi4vZGVjb3JhdG9ycy9hdXRvYmluZC50c1wiLz5cclxuLy8gLyA8cmVmZXJlbmNlIHBhdGg9XCIuL2NvbXBvbmVudHMvYmFzZS1jb21wb25lbnQudHNcIi8+XHJcbi8vIC8gPHJlZmVyZW5jZSBwYXRoPVwiLi9jb21wb25lbnRzL3Byb2plY3QtaW5wdXQudHNcIi8+XHJcbi8vIC8gPHJlZmVyZW5jZSBwYXRoPVwiLi9jb21wb25lbnRzL3Byb2plY3QtaXRlbS50c1wiLz5cclxuLy8gLyA8cmVmZXJlbmNlIHBhdGg9XCIuL2NvbXBvbmVudHMvcHJvamVjdC1saXN0LnRzXCIvPlxyXG4vLyAvIDxyZWZlcmVuY2UgcGF0aD1cIi4vdHlwZXMvdHVwbGUtdm9pZC50c1wiLz5cclxuaW1wb3J0IHsgUHJvamVjdElucHV0IH0gZnJvbSAnLi9jb21wb25lbnRzL3Byb2plY3QtaW5wdXQnO1xyXG5pbXBvcnQgeyBQcm9qZWN0TGlzdCB9IGZyb20gJy4vY29tcG9uZW50cy9wcm9qZWN0LWxpc3QnO1xyXG5cclxubmV3IFByb2plY3RJbnB1dCgpO1xyXG5uZXcgUHJvamVjdExpc3QoJ2FjdGl2ZScpO1xyXG5uZXcgUHJvamVjdExpc3QoJ2ZpbmlzaGVkJyk7XHJcblxyXG5jb25zb2xlLmxvZygnSGknKTtcclxuXHJcbiJdLCJuYW1lcyI6WyJDb21wb25lbnQiLCJjb25zdHJ1Y3RvciIsInRlbXBsYXRlSWQiLCJob3N0RWxlbWVudElkIiwiaW5zZXJ0U3RhcnQiLCJuZXdFbGVtZW50SWQiLCJ0aGlzIiwidGVtcGxhdGVFbGVtZW50IiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImhvc3RFbGVtZW50IiwiaW1wb3J0ZWROb2RlIiwiaW1wb3J0Tm9kZSIsImNvbnRlbnQiLCJlbGVtZW50IiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJpZCIsImF0dGFjaCIsImluc2VydEFkamFjZW50RWxlbWVudCIsInZhbGlkYXRlIiwiaW5wdXQiLCJpc1ZhbGlkIiwicmVxdWlyZWQiLCJ2YWx1ZSIsInRvU3RyaW5nIiwidHJpbSIsImxlbmd0aCIsIm1pbiIsIm1heCIsIm1pbkxlbmd0aCIsIm1heExlbmd0aCIsIkF1dG9CaW5kZXIiLCJ0YXJnZXQiLCJtZXRob2ROYW1lIiwiZGVzY3JpcHRvciIsImNvbnNvbGUiLCJsb2ciLCJvcmlnaW5hbE1ldGhvZCIsImNvbmZpZ3VyYWJsZSIsImVudW1lcmFibGUiLCJnZXQiLCJiaW5kIiwiUHJvamVjdFN0YXR1cyIsIlByb2plY3QiLCJ0aXRsZSIsImRlc2NyaXB0aW9uIiwicGVvcGxlIiwic3RhdHVzIiwiUHJvamVjdFN0YXRlIiwibGlzdGVuZXJzIiwiYWRkTGlzdGVuZXIiLCJsaXN0ZXJGdW5jdGlvbiIsInB1c2giLCJzdXBlciIsInByb2plY3RzIiwic3RhdGljIiwiaW5zdGFuY2UiLCJhZGRQcm9qZWN0cyIsIm5ld1Byb2plY3QiLCJNYXRoIiwicmFuZG9tIiwiRGF0ZSIsImdldE1pbGxpc2Vjb25kcyIsIkFjdGl2ZSIsInVwZGF0ZUxpc3RlbmVycyIsIm1vdmVQcm9qZWN0IiwicHJvamVjdElkIiwibmV3U3RhdHVzIiwicHJvamVjdCIsImZpbmQiLCJsaXN0ZW5lckZ1bmN0aW9uIiwic2xpY2UiLCJwcm9qZWN0U3RhdGUiLCJnZXRJbnN0YW5jZSIsIlByb2plY3RJbnB1dCIsInRpdGxlSW5wdXRFbGVtZW50IiwicXVlcnlTZWxlY3RvciIsImRlc2NyaXB0aW9uSW5wdXRFbGVtZW50IiwicGVvcGxlSW5wdXRFbGVtZW50IiwiY29uZmlndXJlIiwiYWRkRXZlbnRMaXN0ZW5lciIsInN1Ym1pdEhhbmRsZXIiLCJyZW5kZXJDb250ZW50IiwiZ2V0VXNlcklucHV0IiwiZW50ZXJlZFRpdGxlIiwiZGVzY3JpcHRpb25WYWxpZGF0YWJsZSIsInBlb3BsZVZhbGlkYXRhYmxlIiwiYWxlcnQiLCJldmVudCIsInByZXZlbnREZWZhdWx0IiwidXNlcklucHV0IiwiQXJyYXkiLCJpc0FycmF5IiwiY2xlYXJJbnB1dCIsIlByb2plY3RJdGVtIiwiaG9zdElkIiwicGVyc29ucyIsImRyYWdTdGFydEhhbmRsZXIiLCJkYXRhVHJhbnNmZXIiLCJzZXREYXRhIiwiZWZmZWN0QWxsb3dlZCIsImRyYWdFbmRIYW5kbGVyIiwidGV4dENvbnRlbnQiLCJQcm9qZWN0TGlzdCIsInR5cGUiLCJhc3NpZ25lZFByb2plY3RzIiwiZHJhZ092ZXJIYW5kbGVyIiwidHlwZXMiLCJjbGFzc0xpc3QiLCJhZGQiLCJkcm9wSGFuZGxlciIsImdldERhdGEiLCJGaW5pc2hlZCIsImRyYWdMZWF2ZUhhbmRsZXIiLCJyZW1vdmUiLCJyZWxldmFudFByb2plY3RzIiwiZmlsdGVyIiwicHJqIiwicmVuZGVyUHJvamVjdHMiLCJsaXN0SWQiLCJ0b1VwcGVyQ2FzZSIsImlubmVySFRNTCIsInByb2plY3RJdGVtIl0sInNvdXJjZVJvb3QiOiIifQ==